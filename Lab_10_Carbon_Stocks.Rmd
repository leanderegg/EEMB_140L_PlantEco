---
title: "Lab_10_Carbon_stocks"
output: html_document
date: "2023-02-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# helpful packages
library(tidyverse)
library(ggplot2)

```

## Carbon Stocks

In this Markdown, you will be working with your tree stand data to...


1) Make sure your group's tree stand survey data is completely entered

2) Read in your data here:
```{r}

# stand_data <- read.csv("title.csv")

stand_data <- read.csv("stand_data_test.csv")

```

3) Calculate tree stand density for each plot

First, you need to calculate the area that you surveyed, which was a circle with a 5 meter diameter:
```{r}

# A = pi*r^2
survey_area <- pi * 5^2

```

Then, you can get a count of the total number of trees in each plot using...
```{r}

tree_density <- stand_data %>% 
  group_by(survey_number) %>%  # first, group by each survey
  count() %>% # then get total number of trees in each survey
  mutate(density = (n / survey_area) * 10000)# this adds a new column called "density" that divides the count column by our survey area and multiples by 10,000 to get trees per hectare

```

Question 1) Look at this new data set called "tree_density", do all the plots seem similar in density or do any stand out?
(write answer here)

3) Calculate the stand basal area (cm2 stem area per hectare)

There are lots of ways to do this! One way is to first create a new column calculating each trees basal area, that is, use the diameter to calculate the area. Then group again by survey_number. Next, create another column called stand_basal_area where you divide the mean basal_area column by the survey area and multiply by 10,000 to get the basal area per hectare

```{r}
tree_basal_area <- stand_data %>% 
  mutate(basal_area = pi * DBH_cm^2) %>% 
  group_by(survey_number) %>% 
  mutate(stand_basal_area = mean(basal_area) / survey_area * 10000)

```

4) Calculate average stand height

First, we need to create a new column where we calculate tree height. Remember, this is done by multiplying the degrees (make sure to divide by 100) by the distance, but don't forget to subtract the height of your eyes!
```{r}
stand_height <- stand_data %>% 
  mutate(tree_height = ((angle_degrees/100) * distance_m) - eye_height_m) %>% 
  group_by(survey_number) %>% 
  summarise(mean_stand_height = mean(tree_height))

```

5) Use an allometric equation to plot standing biomass

In order to determine the above ground biomass of our eucs, we could simply treat them as a column using our calculations for height and diameter; however, this tends to be inaccurate.  Instead, researches have determined more accurate and sometimes species-specific allometric equations.  For today, we will be using the AGB = 0.009(dbh)^3.638, which other researchers determined for a similar species of eucalyptus.

So we can simply make a new column for above-ground biomass (in kg) using the mutate() function, and then add this up for each survey
```{r}
tree_biomass <- stand_data %>%
  mutate(agb = 0.009 * DBH_cm^3.638) %>% 
  group_by(survey_number) %>% 
  summarise(total_biomass = sum(agb))

```

6) Calculate above-ground carbon

Using our estmates for above-ground biomass, we can now determine the amount of carbon stored within each survey site

To do this, we will multiply the biomass by 35%, which is approximately the amount of carbon present that researchers found have found when processing eucalyptus tree core samples.

```{r}
tree_carbon <- tree_biomass %>% 
  mutate(plot_carbon = total_biomass * .35)

```

7) Oak tree above-ground carbon storage
